version: 2

models:
  - name: regions
    columns:
      - name: region_id
        tests:
          - unique
          - not_null
      - name: size_rank
        tests:
          - not_null
      - name: region_name
        tests:
          - not_null
      - name: region_type
        tests:
          - not_null

  - name: regional_home_values
    columns:
      - name: region_id
        tests:
          - not_null
          - relationships:
              to: ref('regions')
              field: region_id
      - name: month_end_date
        tests:
          - not_null
      - name: home_value
        tests:
          - not_null
      - name: yoy_growth_rate
        tests:
          - accepted_values:
              values: [null]
              quote: false
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: -1
              max_value: 1
              or_equal_to: true

  - name: regions_date_spine
    columns:
      - name: month_end_date
        tests:
          - unique
          - not_null
      - name: year_number
        tests:
          - not_null
      - name: month_number
        tests:
          - not_null
          - accepted_values:
              values:
                [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                #["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"]
      - name: quarter_number
        tests:
          - not_null
          - accepted_values:
              values: ["1", "2", "3", "4"]
      - name: season_name
        tests:
          - not_null
          - accepted_values:
              values: ["Winter", "Spring", "Summer", "Fall"]
